<script type="text/javascript"><!--
$(document).ready(function(){
	$('.nav.nav-tabs li:first-child a').tab('show');
});
var owl = $("#owl-images");
owl.owlCarousel({
	responsiveBaseWidth: '.container',
	itemsCustom: [[0, 2], [448, 3], [650, 3], [750, 3], [970, 4]],
	navigation : true,
	navigationText: ['<i class="fa fa-chevron-left fa-5x"></i>', '<i class="fa fa-chevron-right fa-5x"></i>'],
	pagination: false
});
$('select[name=\'recurring_id\'], input[name="quantity"]').change(function(){
	$.ajax({
		url: 'index.php?route=product/product/getRecurringDescription',
		type: 'post',
		data: $('input[name=\'product_id\'], input[name=\'quantity\'], select[name=\'recurring_id\']'),
		dataType: 'json',
		beforeSend: function() {
			$('#recurring-description').html('');
		},
		success: function(json) {
			$('.alert, .text-danger').remove();
			if (json['success']) {
				$('#recurring-description').html(json['success']);
			}
		}
	});
});
$('.date').datetimepicker({
	pickTime: false
});
$('.datetime').datetimepicker({
	pickDate: true,
	pickTime: true
});
$('.time').datetimepicker({
	pickDate: false
});
$('button[id^=\'button-upload\']').on('click', function() {
	var node = this;
	$('#form-upload').remove();
	$('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');
	$('#form-upload input[name=\'file\']').trigger('click');
	if (typeof timer != 'undefined') {

		clearInterval(timer);
	}
	timer = setInterval(function() {
		if ($('#form-upload input[name=\'file\']').val() != '') {
			clearInterval(timer);
			$.ajax({
				url: 'index.php?route=tool/upload',
				type: 'post',
				dataType: 'json',
				data: new FormData($('#form-upload')[0]),
				cache: false,
				contentType: false,
				processData: false,
				beforeSend: function() {
					$(node).button('loading');
				},
				complete: function() {
					$(node).button('reset');
				},
				success: function(json) {
					$('.text-danger').remove();
					if (json['error']) {
						$(node).parent().find('input').after('<div class="text-danger">' + json['error'] + '</div>');
					}
					if (json['success']) {
						alert(json['success']);
						$(node).parent().find('input').attr('value', json['code']);
					}
				},
				error: function(xhr, ajaxOptions, thrownError) {
					alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
				}
			});
		}
	}, 500);
});
$('#review').delegate('.pagination a', 'click', function(e) {
	e.preventDefault();
	$('#review').fadeOut('slow');
	$('#review').load(this.href);
	$('#review').fadeIn('slow');
});
$('#review').load('index.php?route=product/product/review&product_id=64');
$('#button-review').on('click', function() {
	$.ajax({
		url: 'index.php?route=product/product/write&product_id=64',
		type: 'post',
		dataType: 'json',
		data: $(".form-review").serialize(),
		beforeSend: function() {
			$('#button-review').button('loading');
		},
		complete: function() {
			$('#button-review').button('reset');
		},
		success: function(json) {
			$('.alert-success, .alert-danger').remove();
			if (json['error']) {
				get_revpopup_notification('alert-danger', 'Ошибка', json['error']);
			}
			if (json['success']) {
				get_revpopup_notification('alert-success', 'Спасибо за отзыв', json['success']);
				$('input[name=\'name\']').val('');
				$('textarea[name=\'text\']').val('');
				$('input[name=\'rating\']:checked').prop('checked', false);
				$('#post-review-box').slideUp(300);
				$('#new-review').focus();
				$('#open-review-box').fadeIn(200);
				$('#close-review-box').hide();
				$('#ratings-hidden').val('');
				$('.stars .glyphicon').removeClass('glyphicon-star').addClass('glyphicon-star-empty');
			}
		}
	});
});
$('.thumbnails .main-image').magnificPopup({
	type:'image',
	callbacks: {
		open: function() {
			$('body').addClass('razmiv2');
			$('#pagefader2').fadeIn(70);
			if (document.body.scrollHeight > document.body.offsetHeight) {
				$('#top3').css('right', '8.5px');
			}
		},
		close: function() {
			$('body').removeClass('razmiv2');
			$('#pagefader2').fadeOut(70);
			$('#top3').css('right', 'initial');
		}
	}
});
$('.thumbnails .images-additional').magnificPopup({
	type:'image',
	delegate: 'a',
	gallery: {
		enabled:true
	},
	callbacks: {
		open: function() {
			$('body').addClass('razmiv2');
			$('#pagefader2').fadeIn(70);
			if (document.body.scrollHeight > document.body.offsetHeight) {
				$('#top3').css('right', '8.5px');
			}
		},
		close: function() {
			$('body').removeClass('razmiv2');
			$('#pagefader2').fadeOut(70);
			$('#top3').css('right', 'initial');
		}
	}
});
$('.thumbnails .main-image img').click(function(){
	if ($('.images-additional').length > 0) {
		var startnumber = $(this).parent().attr('data-number');
		$('.images-additional').magnificPopup('open', startnumber);
		return false
	} else {
		$(this).magnificPopup('open');
		return false
	}
});
function get_revpopup_cart_quantity() {
	input_val = $('.product-info.product_informationss .plus-minus').val();
	quantity = parseInt(input_val);
	return quantity;
}
function validate_pole(val, product_id, znak, minimumvalue, maximumvalue) {
	val.value = val.value.replace(/[^\d,]/g, '');
	if (val.value == '') val.value = minimumvalue;
	maximumvalue = Number($('.product_informationss .pr_quantity').text());
	if (maximumvalue == 0) maximumvalue = 9999;
	input_val = $('.product-info.product_informationss .plus-minus');
	quantity = parseInt(input_val.val());
	if(znak=='+' && input_val.val() < maximumvalue) input_val.val(quantity+1);
	else if(znak=='-' && input_val.val() > minimumvalue) input_val.val(quantity-1);
	else if(znak=='=' && input_val.val() < maximumvalue && input_val.val() < maximumvalue) input_val.val(input_val.val());
	if (quantity < 1 || quantity < minimumvalue) {
		input_val.val(minimumvalue);
		val.value = minimumvalue;
	} else if (quantity > maximumvalue) {
		input_val.val(maximumvalue);
		val.value = maximumvalue;
	}
	update_quantity(product_id, input_val.val());
}
function update_quantity(product_id, quantity) {
	var minimumvalue = 1;
	if (quantity == 0 || quantity < minimumvalue) {
		quantity = $('.product-info.product_informationss .plus-minus').val(minimumvalue);
		return;
	} else if (quantity < 1) {
		quantity = 1;
		return;
	}
	data = $('.product-info.product_informationss input[type=\'text\'], .product-info.product_informationss input[type=\'hidden\'], .product-info.product_informationss input[type=\'radio\']:checked, .product-info.product_informationss input[type=\'checkbox\']:checked, .product-info.product_informationss select, .product-info.product_informationss textarea'),
			$.ajax({
				url: 'index.php?route=product/product/update_prices',
				type: 'post',
				dataType: 'json',
				data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
				success: function(json) {

					var start_price = parseFloat($('.product_informationss .update_price').html().replace(/\s*/g,''));
					var price = json['price_n'];
					$({val:start_price}).animate({val:price}, {
						duration: 500,
						easing: 'swing',
						step: function(val) {
							$('.product_informationss .update_price').html(price_format(val));
						}
					});
					var start_special = parseFloat($('.product_informationss .update_special').html().replace(/\s*/g,''));
					var special = json['special_n'];
					$({val:start_special}).animate({val:special}, {
						duration: 500,
						easing: 'swing',
						step: function(val) {
							$('.product_informationss .update_special').html(price_format(val));
						}
					});
				}
			});
}
function update_prices_product(product_id, minimumvalue) {
	input_val = $('.product-info.product_informationss .plus-minus').val();
	if (input_val > minimumvalue) {
		input_val = minimumvalue;
		$('.product-info.product_informationss .plus-minus').val(minimumvalue);
	}
	quantity = parseInt(input_val);
	data = $('.product-info.product_informationss input[type=\'text\'], .product-info.product_informationss input[type=\'hidden\'], .product-info.product_informationss input[type=\'radio\']:checked, .product-info.product_informationss input[type=\'checkbox\']:checked, .product-info.product_informationss select, .product-info.product_informationss textarea');
	$.ajax({
		type: 'post',
		url: 'index.php?route=product/product/update_prices',
		data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
		dataType: 'json',
		success: function(json) {
			$('.product_informationss .thumbnails a.main-image').attr('href', json['opt_image_2_big']);
			$('.product_informationss .thumbnails a.main-image img').attr('src', json['opt_image_2']);
			$('.product_informationss .thumbnails .images-additional a:first-child').attr('href', json['opt_image_2_big']);
			$('.product_informationss .thumbnails .images-additional a:first-child img').attr('src', json['opt_image_2']).css('width', 69).css('height', 69);
			var start_quantity = parseFloat($('.product_informationss .pr_quantity').html().replace(/\s*/g,''));
			var end_quantity = json['option_quantity'];
			$({val:start_quantity}).animate({val:end_quantity}, {
				duration: 500,
				easing: 'swing',
				step: function(val) {
					$('.product_informationss .pr_quantity').html(number_format(val, product_id));
				}
			});

			var start_price = parseFloat($('.product_informationss .update_price').html().replace(/\s*/g,''));
			var price = json['price_n'];
			$({val:start_price}).animate({val:price}, {
				duration: 500,
				easing: 'swing',
				step: function(val) {
					$('.product_informationss .update_price').html(price_format(val));
				}
			});
			var start_special = parseFloat($('.product_informationss .update_special').html().replace(/\s*/g,''));
			var special = json['special_n'];
			$({val:start_special}).animate({val:special}, {
				duration: 500,
				easing: 'swing',
				step: function(val) {
					$('.product_informationss .update_special').html(price_format(val));
				}
			});
		}
	});
}
function update_options_buy(product_id, opt_id, option) {
	$('.product-info.product_informationss .options_buy .pro_'+option+' input[name=\'option['+opt_id+']\']').val(option);
	data = $('.product-info.product_informationss .options_buy .pro_'+option+' input[type=\'text\'], .product-info.product_informationss .options_buy .pro_'+option+' input[type=\'hidden\'], .product-info.product_informationss .options_buy .pro_'+option+' input[type=\'radio\']:checked, .product-info.product_informationss .options_buy .pro_'+option+' input[type=\'checkbox\']:checked, .product-info.product_informationss .options_buy .pro_'+option+' select, .product-info.product_informationss .options_buy .pro_'+option+' textarea');
	$.ajax({
		type: 'post',
		url: 'index.php?route=product/product/update_prices',
		data: data.serialize() + '&product_id=' + product_id,
		dataType: 'json',
		success: function(json) {
			$('.product_informationss .thumbnails a.main-image').attr('href', json['opt_image_2_big']);
			$('.product_informationss .thumbnails a.main-image img').attr('src', json['opt_image_2']);
			$('.product_informationss .thumbnails .images-additional a:first-child').attr('href', json['opt_image_2_big']);
			$('.product_informationss .thumbnails .images-additional a:first-child img').attr('src', json['opt_image_2']).css('width', 69).css('height', 69);

			var start_quantity = parseFloat($('.product_informationss .pr_quantity').html().replace(/\s*/g,''));
			var end_quantity = json['option_quantity'];
			$({val:start_quantity}).animate({val:end_quantity}, {
				duration: 500,
				easing: 'swing',
				step: function(val) {
					$('.product_informationss .pr_quantity').html(number_format(val, product_id));
				}
			});
		}
	});
}
function price_format(n) {
	c = 0;
	d = '.';
	t = ' ';
	s_left = '';
	s_right = ' р.';
	n = n * 1.00000000;
	i = parseInt(n = Math.abs(n).toFixed(c)) + '';
	j = ((j = i.length) > 3) ? j % 3 : 0;
	return s_left + (j ? i.substr(0, j) + t : '') + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : '') + s_right;
}
function weight_format(n, product_id) {
	c = 2;
	d = '.';
	t = ',';
	n = n * 1.00000000;
	i = parseInt(n = Math.abs(n).toFixed(c)) + '';
	j = ((j = i.length) > 3) ? j % 3 : 0;
	return (j ? i.substr(0, j) + t : '') + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : '');
}
function number_format(n, product_id) {
	i = parseInt(n = Math.abs(n).toFixed(0)) + '';
	return i;
}
$('.owl-carousel.owlproduct').remove();
--></script></section><footer><div id="revsubscribe"><div class="container"><div class="row"><form id="revsubscribe_form"><div class="col-sm-5 col-xs-12"><div class="revtext"><i class="fa fa-envelope-o" aria-hidden="true"></i><span class="susbs_head_text">Подписка на новости</span><br>Будьте в курсе новых акций и спецпредложений!
</div><div id="revsubscribe_success"></div></div><div class="col-sm-4 col-xs-6"><input type="text" class="form-control" name="revs_email" id="revs_email" placeholder="Ваш e-mail" value="" /><input type="hidden" name="language_id" id="language_id" value="1" /><input type="hidden" name="store_id" id="store_id" value="0" /></div><div class="col-sm-3 col-xs-6"><a id="revsubscribe_submit" class="btn btn-primary">Подписаться</a></div></form></div></div></div><script type="text/javascript"><!--
$( "#revsubscribe_form" ).submit(function( event ) {
	$('#revsubscribe_submit').click();
	event.preventDefault();
});
$('#revsubscribe_submit').on('click', function(){
	var email_validate = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
	if ((document.getElementById("revs_email").value.length == 0)) {
		var message = 'Укажите Ваш e-mail адрес.';
		get_revpopup_notification('alert-danger', 'Ошибка', message);
	} else if (!document.getElementById("revs_email").value.match(email_validate)) {
		var message = 'Не верно указан e-mail адрес.';
		get_revpopup_notification('alert-danger', 'Ошибка', message);
	} else {
		$.ajax({
			url: 'index.php?route=revolution/revsubscribe/subscribecustomer',
			type: 'post',
			data: $('#revsubscribe_form').serialize(),
			success: function(response) {
				get_revpopup_notification('alert-success', 'Спасибо за подписку', response);
				$('#revs_email').val('');
			}
		});
	}
});
//--></script><div class="footer"><div class="container"><div class="row"><div class="footer_links col-sm-8 col-xs-12"><a href="https://coilslab.ru/about_us">О магазине</a><a href="https://coilslab.ru/wholesale">Оптовикам</a><a href="https://coilslab.ru/delivery">Доставка и оплата</a><a href="https://coilslab.ru/privacy">Политика Безопасности</a><a href="https://coilslab.ru/terms">Условия соглашения</a></div><div class="soc_s col-sm-4 col-xs-12"><a href="https://vk.com/coilslab_ru"><i class="fa fa-vk" data-toggle="tooltip" title="В Контакте"></i></a><a href="https://www.instagram.com/coilslab.ru/"><i class="fa fa-instagram" data-toggle="tooltip" title="Instagram"></i></a><a href="https://www.facebook.com/coilslab.ru/"><i class="fa fa-facebook-square" data-toggle="tooltip" title="Facebook"></i></a></div><div class="ficons col-sm-6 col-xs-12"><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/alfa-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/sberbank-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/yandex-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/visa-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/master-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/sdek-50x30.png" alt=""/></span><span class="revtheme_footer_icon"><img src="https://coilslab.ru/image/cache/catalog/revolution/payment/mailofrussia-50x30.png" alt=""/></span></div><div style="text-align:right" class="powered col-sm-6 col-xs-12">CoilsLab.ru - готовые спирали, намотки, койлы. Доставка по РФ © 2017</div></div></div></div></footer><div class="scroll-top-wrapper "><span class="scroll-top-inner"><i class="fa fa-arrow-circle-up"></i></span></div><script src="catalog/view/javascript/bootstrap/js/bootstrap.min.js" type="text/javascript"></script><script src="catalog/view/javascript/revolution/common.js" type="text/javascript"></script><script type="text/javascript"><!--
if($(window).width() > 768) {
	$('#top3').affix({
		offset: {
			top: $('#top').outerHeight()+$('#top2').outerHeight()+$('html.common-home #menu2.inhome').outerHeight()
		}
	});
}
$(function() {
	if (localStorage.getItem('display') == 'list') {
		$('#list-view').trigger('click');
	} else if (localStorage.getItem('display') == 'price') {
		$('#price-view').trigger('click');
	} else if (localStorage.getItem('display') == 'grid') {
		$('#grid-view').trigger('click');
	} else {
		$('#grid-view').trigger('click');
	}
	podgon_fona();
	$(window).resize(podgon_fona);
});
function podgon_fona() {
	toggle_ellipses();
	var h_top5 = $('.inhome #menu2').outerHeight();
	if (h_top5) {
		$('#top5').css('min-height', h_top5+20);
	}
	var m2inh = $('html.common-home #menu2.inhome').outerHeight();
	$('html.common-home #menu2.inhome .podmenu2').css('height', m2inh);
	var m2inhw = $('html.common-home #menu2_button').outerWidth();
	$('html.common-home #menu2.inhome .podmenu2').css('min-width', m2inhw-0.5);
	var h_top3 = $('#top3').outerHeight();
	$('.main-content').css('padding-top', h_top3+25);
	$('#top3').addClass('absolutpo');
	if($(window).width() < 767) {
		$('#grid-view').trigger('click');
	}
	var product_grid_width = $('.product-layout .product-thumb').outerWidth();
	if (product_grid_width < 240) {
		$('.product-layout').addClass('new_line');
	} else {
		$('.product-layout').removeClass('new_line');
	}
	max_height_div('.product-grid .product-thumb .description');
	max_height_div('.product-grid .product-thumb .description_options');
	max_height_div('.product-grid .product-thumb .price');
}
function toggle_ellipses() {
	var ellipses1 = $('.br_ellipses');
	var howlong = $('.breadcrumb li:hidden').length;
	if ($('.breadcrumb li:hidden').length > 1) {
		ellipses1.show().css('display', 'inline');
	} else {
		ellipses1.hide();
	}
}
$(document).on( 'scroll', function(){
	if ($(window).scrollTop() > 100) {
		$('.scroll-top-wrapper').addClass('show');
	} else {
		$('.scroll-top-wrapper').removeClass('show');
	}
});
$('.scroll-top-wrapper').on('click', scrollToTop);
$('.popup-phone-wrapper').on('click', get_revpopup_phone);
function scrollToTop() {
	verticalOffset = typeof(verticalOffset) != 'undefined' ? verticalOffset : 0;
	element = $('body');
	offset = element.offset();
	offsetTop = offset.top;
	$('html, body').animate({scrollTop: offsetTop}, 200, 'linear');
};
function get_revpopup_notification(m_class, m_header, message) {
	if (document.body.scrollHeight > document.body.offsetHeight) {
		$('#top3.absolutpo').css('right', '8.5px');
	}
	$.magnificPopup.open({
		removalDelay: 300,
		callbacks: {
			beforeOpen: function() {
				this.st.mainClass = 'mfp-zoom-in';
			},
			open: function() {
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			close: function() {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
				$('#top3.absolutpo').css('right', 'initial');
			}
		},
		tLoading: '',
		items: {
			src: $('<div class="popup_notification"><div class="popup_notification_heading '+m_class+'">'+m_header+'</div><div class="popup_notification_message">'+message+'</div></div>'),
			type: 'inline'
		}
	});
}
function get_revpopup_phone() {
	if (document.body.scrollHeight > document.body.offsetHeight) {
		$('#top3.absolutpo').css('right', '8.5px');
	}
	$.magnificPopup.open({
		removalDelay: 300,
		callbacks: {
			beforeOpen: function() {
				this.st.mainClass = 'mfp-zoom-in';
				$('.dropdown-menu.dop_contss').fadeOut(70);
			},
			open: function() {
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			close: function() {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
				$('#top3.absolutpo').css('right', 'initial');
				$('.dropdown-menu.dop_contss').css('display', '');
			}
		},
		tLoading: '',
		items: {
			src: 'index.php?route=revolution/revpopupphone',
			type: 'ajax'
		}
	});
}
function get_revpopup_view(product_id) {
	if (document.body.scrollHeight > document.body.offsetHeight) {
		$('#top3.absolutpo').css('right', '8.5px');
	}
	$.magnificPopup.open({
		removalDelay: 300,
		callbacks: {
			beforeOpen: function() {
				this.st.mainClass = 'mfp-zoom-in';
			},
			open: function() {
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			close: function() {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
				$('#top3.absolutpo').css('right', 'initial');
			}
		},
		tLoading: '',
		items: {
			src: 'index.php?route=revolution/revpopupview&product_id='+product_id,
			type: 'ajax'
		}
	});
}
function get_revpopup_purchase(product_id) {
	if (document.body.scrollHeight > document.body.offsetHeight) {
		$('#top3.absolutpo').css('right', '8.5px');
	}
	$.magnificPopup.open({
		removalDelay: 300,
		callbacks: {
			beforeOpen: function() {
				this.st.mainClass = 'mfp-zoom-in';
			},
			open: function() {
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			close: function() {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
				$('#top3.absolutpo').css('right', 'initial');
			}
		},
		tLoading: '',
		items: {
			src: 'index.php?route=revolution/revpopuporder&product_id='+product_id,
			type: 'ajax'
		}
	});
}
function get_revpopup_cart( product_id, action, quantity, block_id ) {
	quantity = typeof(quantity) != 'undefined' ? quantity : 1;
	if ( action == "catalog" ) {
		data = $('.products_category .product_'+product_id+' .options input[type=\'text\'], .products_category .product_'+product_id+' .options input[type=\'hidden\'], .products_category .product_'+product_id+' .options input[type=\'radio\']:checked, .products_category .product_'+product_id+' .options input[type=\'checkbox\']:checked, .products_category .product_'+product_id+' .options select');
		$.ajax({
			url: 'index.php?route=checkout/cart/add',
			type: 'post',
			data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
			dataType: 'json',
			success: function( json ) {
				$('.alert, .text-danger').remove();
				$('.form-group').removeClass('has-error');
				$('.success, .warning, .attention, information, .error').remove();
				if ( json['redirect'] ) {
					location = json['redirect'];
				}
				if ( json['success'] ) {
					if (document.body.scrollHeight > document.body.offsetHeight) {
						$('#top3.absolutpo').css('right', '8.5px');
					}
					$.magnificPopup.open({
						removalDelay: 300,
						callbacks: {
							beforeOpen: function() {
								this.st.mainClass = 'mfp-zoom-in';
							},
							close: function() {
								$('body').removeClass('razmiv2');
								$('#pagefader2').fadeOut(70);
								$('#top3.absolutpo').css('right', 'initial');
							}
						},
						tLoading: '',
						items: {
							src: 'index.php?route=revolution/revpopupcart',
							type: 'ajax'
						}
					});
					$('#cart-total' ).html(json['total']);
					$('#cart-total-popup').html(json['total']);
					$('#cart > ul').load('index.php?route=common/cart/info ul li');
				}
			}
		});
	}
	if ( action == "catalog_mod" ) {
		data = $('.products_category .product_'+product_id+' .options input[type=\'text\'], .products_category .product_'+product_id+' .options input[type=\'hidden\'], .products_category .product_'+product_id+' .options input[type=\'radio\']:checked, .products_category .product_'+product_id+' .options input[type=\'checkbox\']:checked, .products_category .product_'+product_id+' .options select');
		$.ajax({
			url: 'index.php?route=checkout/cart/add',
			type: 'post',
			data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
			dataType: 'json',
			success: function( json ) {
				$('.alert, .text-danger').remove();
				$('.form-group').removeClass('has-error');
				$('.success, .warning, .attention, information, .error').remove();
				if ( json['redirect'] ) {
					location = json['redirect'];
				}
				if ( json['success'] ) {
					if (document.body.scrollHeight > document.body.offsetHeight) {
						$('#top3.absolutpo').css('right', '8.5px');
					}
					$.magnificPopup.open({
						removalDelay: 300,
						callbacks: {
							beforeOpen: function() {
								this.st.mainClass = 'mfp-zoom-in';
							},
							close: function() {
								$('body').removeClass('razmiv2');
								$('#pagefader2').fadeOut(70);
								$('#top3.absolutpo').css('right', 'initial');
							}
						},
						tLoading: '',
						items: {
							src: 'index.php?route=revolution/revpopupcart',
							type: 'ajax'
						}
					});
					$('#cart-total' ).html(json['total']);
					$('#cart-total-popup').html(json['total']);
					$('#cart > ul').load('index.php?route=common/cart/info ul li');
				}
			}
		});
	}
	if ( action == "product" ) {
		data = $('.product-info input[type=\'text\'], .product-info input[type=\'hidden\'], .product-info input[type=\'radio\']:checked, .product-info input[type=\'checkbox\']:checked, .product-info select, .product-info textarea'),
				$.ajax({
					url: 'index.php?route=checkout/cart/add',
					type: 'post',
					data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
					dataType: 'json',
					beforeSend: function(){
						$('body').addClass('razmiv2');
						$('#pagefader2').fadeIn(70);
					},
					success: function( json ) {
						$('.alert, .text-danger').remove();
						$('.form-group').removeClass('has-error');
						$('.success, .warning, .attention, information, .error').remove();
						if (json['error']) {
							$('body').removeClass('razmiv2');
							$('#pagefader2').fadeOut(70);
							if (json['error']['option']) {
								for (i in json['error']['option']) {
									$('#input-option' + i).before('<span class="error bg-danger">' + json['error']['option'][i] + '</span>');
								}
							}
						}
						if ( json['success'] ) {
							if (document.body.scrollHeight > document.body.offsetHeight) {
								$('#top3.absolutpo').css('right', '8.5px');
							}
							$.magnificPopup.open({
								removalDelay: 300,
								callbacks: {
									beforeOpen: function() {
										this.st.mainClass = 'mfp-zoom-in';
									},
									close: function() {
										$('body').removeClass('razmiv2');
										$('#pagefader2').fadeOut(70);
										$('#top3.absolutpo').css('right', 'initial');
									}
								},
								tLoading: '',
								items: {
									src: 'index.php?route=revolution/revpopupcart',
									type: 'ajax'
								}
							});
							$('#cart-total' ).html(json['total']);
							$('#cart-total-popup').html(json['total']);
							$('#cart > ul').load('index.php?route=common/cart/info ul li');
						}
					}
				});
	}
	if ( action == "popup_product" ) {
		data = $('#popup-view-wrapper .product-info input[type=\'text\'], #popup-view-wrapper .product-info input[type=\'hidden\'], #popup-view-wrapper .product-info input[type=\'radio\']:checked, #popup-view-wrapper .product-info input[type=\'checkbox\']:checked, #popup-view-wrapper .product-info select, #popup-view-wrapper .product-info textarea');
		$.ajax({
			url: 'index.php?route=checkout/cart/add',
			type: 'post',
			data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
			dataType: 'json',
			beforeSend: function(){
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			success: function( json ) {
				$('.alert, .text-danger').remove();
				$('.form-group').removeClass('has-error');
				$('.success, .warning, .attention, information, .error').remove();
				if (json['error']) {
					$('body').removeClass('razmiv2');
					$('#pagefader2').fadeOut(70);
					if (json['error']['option']) {
						for (i in json['error']['option']) {
							$('#input-option' + i).before('<span class="error bg-danger">' + json['error']['option'][i] + '</span>');
						}
					}
				}
				if ( json['success'] ) {
					if (document.body.scrollHeight > document.body.offsetHeight) {
						$('#top3.absolutpo').css('right', '8.5px');
					}
					$.magnificPopup.open({
						removalDelay: 300,
						callbacks: {
							beforeOpen: function() {
								this.st.mainClass = 'mfp-zoom-in';
							},
							close: function() {
								$('body').removeClass('razmiv2');
								$('#pagefader2').fadeOut(70);
								$('#top3.absolutpo').css('right', 'initial');
							}
						},
						tLoading: '',
						items: {
							src: 'index.php?route=revolution/revpopupcart',
							type: 'ajax'
						}
					});
					$('#cart-total' ).html(json['total']);
					$('#cart-total-popup').html(json['total']);
					$('#cart > ul').load('index.php?route=common/cart/info ul li');
				}
			}
		});
	}
	if ( action == "show_cart" ) {
		if (document.body.scrollHeight > document.body.offsetHeight) {
			$('#top3.absolutpo').css('right', '8.5px');
		}
		$.magnificPopup.open({
			removalDelay: 300,
			callbacks: {
				beforeOpen: function() {
					this.st.mainClass = 'mfp-zoom-in';
				},
				open: function() {
					$('body').addClass('razmiv2');
					$('#pagefader2').fadeIn(70);
				},
				close: function() {
					$('body').removeClass('razmiv2');
					$('#pagefader2').fadeOut(70);
					$('#top3.absolutpo').css('right', 'initial');
				}
			},
			tLoading: '',
			items: {
				src: 'index.php?route=revolution/revpopupcart',
				type: 'ajax'
			}
		});
	}
	if ( action == "redirect_cart" ) {
		window.location.href = "index.php?route=checkout/cart"
	}
	if ( action == "module" ) {
		quantity = typeof(quantity) != 'undefined' ? quantity : 1;
		data = $('#'+block_id+' .product_'+product_id+' .options input[type=\'text\'], #'+block_id+' .product_'+product_id+' .options input[type=\'hidden\'], #'+block_id+' .product_'+product_id+' .options input[type=\'radio\']:checked, #'+block_id+' .product_'+product_id+' .options input[type=\'checkbox\']:checked, #'+block_id+' .product_'+product_id+' .options select');
		$.ajax({
			url: 'index.php?route=checkout/cart/add',
			type: 'post',
			data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
			dataType: 'json',
			success: function( json ) {
				$('.alert, .text-danger').remove();
				$('.form-group').removeClass('has-error');
				$('.success, .warning, .attention, information, .error').remove();
				if ( json['redirect'] ) {
					location = json['redirect'];
				}
				if ( json['success'] ) {
					if (document.body.scrollHeight > document.body.offsetHeight) {
						$('#top3.absolutpo').css('right', '8.5px');
					}
					$.magnificPopup.open({
						removalDelay: 300,
						callbacks: {
							beforeOpen: function() {
								this.st.mainClass = 'mfp-zoom-in';
							},
							close: function() {
								$('body').removeClass('razmiv2');
								$('#pagefader2').fadeOut(70);
								$('#top3.absolutpo').css('right', 'initial');
							}
						},
						tLoading: '',
						items: {
							src: 'index.php?route=revolution/revpopupcart',
							type: 'ajax'
						}
					});
					$('#cart-total' ).html(json['total']);
					$('#cart-total-popup').html(json['total']);
					$('#cart > ul').load('index.php?route=common/cart/info ul li');
				}
			}
		});
	}
	if ( action == "module_in_product" ) {
		quantity = typeof(quantity) != 'undefined' ? quantity : 1;
		data = $('#'+block_id+' .product_'+product_id+' .options input[type=\'text\'], #'+block_id+' .product_'+product_id+' .options input[type=\'hidden\'], #'+block_id+' .product_'+product_id+' .options input[type=\'radio\']:checked, #'+block_id+' .product_'+product_id+' .options input[type=\'checkbox\']:checked, #'+block_id+' .product_'+product_id+' .options select');
		$.ajax({
			url: 'index.php?route=checkout/cart/add',
			type: 'post',
			data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
			dataType: 'json',
			beforeSend: function(){
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			success: function( json ) {
				$('.alert, .text-danger').remove();
				$('.form-group').removeClass('has-error');
				$('.success, .warning, .attention, information, .error').remove();
				if ( json['redirect'] ) {
					location = json['redirect'];
				}
				if ( json['success'] ) {
					if (document.body.scrollHeight > document.body.offsetHeight) {
						$('#top3.absolutpo').css('right', '8.5px');
					}
					$.magnificPopup.open({
						removalDelay: 300,
						callbacks: {
							beforeOpen: function() {
								this.st.mainClass = 'mfp-zoom-in';
							},
							close: function() {
								$('body').removeClass('razmiv2');
								$('#pagefader2').fadeOut(70);
								$('#top3.absolutpo').css('right', 'initial');
							}
						},
						tLoading: '',
						items: {
							src: 'index.php?route=revolution/revpopupcart',
							type: 'ajax'
						}
					});
					$('#cart-total' ).html(json['total']);
					$('#cart-total-popup').html(json['total']);
					$('#cart > ul').load('index.php?route=common/cart/info ul li');
				}
			}
		});
	}
}
function get_revpopup_cart_option (opt_id, option, quantity, product_id) {
	$('.options_buy .pro_'+option+' input[name=\'option['+opt_id+']\']').val(option);
	data = $('.product-info .options_buy .pro_'+option+' input[type=\'text\'], .product-info .options_buy .pro_'+option+' input[type=\'hidden\'], .product-info .options_buy .pro_'+option+' input[type=\'radio\']:checked, .product-info .options_buy .pro_'+option+' input[type=\'checkbox\']:checked, .product-info .options_buy .pro_'+option+' select, .product-info .options_buy .pro_'+option+' textarea');
	$.ajax({
		url: 'index.php?route=checkout/cart/add',
		type: 'post',
		data: data.serialize() + '&product_id=' + product_id + '&quantity=' + quantity,
		dataType: 'json',
		beforeSend: function(){
			$('body').addClass('razmiv2');
			$('#pagefader2').fadeIn(70);
		},
		success: function( json ) {
			$('.alert, .text-danger').remove();
			$('.form-group').removeClass('has-error');
			$('.success, .warning, .attention, information, .error').remove();
			if (json['error']) {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
			}
			if ( json['success'] ) {
				if (document.body.scrollHeight > document.body.offsetHeight) {
					$('#top3.absolutpo').css('right', '8.5px');
				}
				$.magnificPopup.open({
					removalDelay: 300,
					callbacks: {
						beforeOpen: function() {
							this.st.mainClass = 'mfp-zoom-in';
						},
						close: function() {
							$('body').removeClass('razmiv2');
							$('#pagefader2').fadeOut(70);
							$('#top3.absolutpo').css('right', 'initial');
						}
					},
					tLoading: '',
					items: {
						src: 'index.php?route=revolution/revpopupcart',
						type: 'ajax'
					}
				});
				$('#cart-total' ).html(json['total']);
				$('#cart-total-popup').html(json['total']);
				$('#cart > ul').load('index.php?route=common/cart/info ul li');
			}
		}
	});
}
function get_revpopup_login() {
	if (document.body.scrollHeight > document.body.offsetHeight) {
		$('#top3.absolutpo').css('right', '8.5px');
	}
	$.magnificPopup.open({
		removalDelay: 300,
		callbacks: {
			beforeOpen: function() {
				this.st.mainClass = 'mfp-zoom-in';
			},
			open: function() {
				$('body').addClass('razmiv2');
				$('#pagefader2').fadeIn(70);
			},
			close: function() {
				$('body').removeClass('razmiv2');
				$('#pagefader2').fadeOut(70);
				$('#top3.absolutpo').css('right', 'initial');
			}
		},
		tLoading: '',
		items: {
			src: 'index.php?route=revolution/revpopuplogin',
			type: 'ajax'
		}
	});
}
$(document).on('click', '.tel .dropdown-menu', function (e) {
	$(this).hasClass('dropdown-menu-right') && e.stopPropagation();
});
var button_more = true; var pagination_exist = false;
var window_height = 0; var product_block_offset = 0; var product_block = '.row > .product-layout'; var pages_count = 0; var pages = [];
function gettNextProductPage(pages, pages_count) {
	if (pages_count >= pages.length) return;
	masked(product_block, true);
	$.ajax({
		url:pages[pages_count],
		type:"GET",
		data:'',
		beforeSend: function(){
			$('.load_more .fa-refresh').addClass('fa-spin');
		},
		success:function (data) {
			$data = $(data);
			masked(product_block, false);
			if ($data) {
				if (localStorage.getItem('display') == 'list') {
					$(product_block).parent().append($data.find('.product-list').parent().html());
					$('#list-view').trigger('click');
					if (product_block == '.product-grid') {$('#grid-view').trigger('click')};
				} else if (localStorage.getItem('display') == 'price') {
					$(product_block).parent().append($data.find('.product-list').parent().html());
					$('#price-view').trigger('click');
				} else {
					$(product_block).parent().append($data.find('.product-list').parent().html());
					$('#grid-view').trigger('click');
				}
				if (pagination_exist) {
					$('.pagination').html($data.find('.pagination'));
				}
				$('.load_more .fa-refresh').removeClass('fa-spin').css('hover');
				if (pages_count+1 >= pages.length) {$('.load_more').hide();};
			}
		}
	});
}
$(document).ready(function(){
	window_height = $(window).height();
	var button_more_block = $('#load_more').html(); //
	if ($(product_block).length > 0) {
		product_block_offset = $(product_block).offset().top;
		var href = $('.pagination').find('li:last a').attr('href');
		$('.pagination').each(function(){
			if (href) {
				TotalPages = href.substring(href.indexOf("page=")+5);
				First_index = $(this).find('li.active span').html();
				i = parseInt(First_index) + 1;
				while (i <= TotalPages) {
					pages.push(href.substring(0,href.indexOf("page=")+5) + i);
					i++;
				}
			}
		});
		if (button_more && href) {
			$('.pagination').parent().parent().before(button_more_block);
			if (!pagination_exist) {
				$('.pagpages').remove();
			}
			$(".load_more").click(function(event) {
				event.preventDefault();
				gettNextProductPage(pages, pages_count);
				pages_count++;
				if (pages_count > 0) {
					var $next = $(".pagpages .pagination li.active").next("li").children("a");
					if ($next.length == 0) return;
					$.get($next.attr("href"), function(data) {
						$data = $(data);
						var pag = $data.find(".pagpages > *");
						var pag2 = pag.filter(".text-right").html();
						var pag_ch = pag2.substr(0,pag2.indexOf(" по")).replace(/[^\d.]/ig, '');
						pag2 = pag2.replace(pag_ch, "1");
						$(".pagpages").html(pag);
						$(".pagpages .text-right").html(pag2);
						$(".owlproduct").not(".owl-theme").owlCarousel({
							beforeInit: true,
							items: 1,
							singleItem: true,
							mouseDrag: false,
							autoPlay: false,
							navigation: true,
							navigationText: ['<i class="fa fa-chevron-left fa-3x"></i>', '<i class="fa fa-chevron-right fa-3x"></i>'],
							pagination: false
						});
					}, "html")
				}
			});
		} else if (href) {
			$('.pagination').parent().parent().hide();
			$(window).scroll(function(){
				product_block = getProductBlock();
				product_block_height = $(product_block).parent().height();
				if (pages.length > 0) {
					if((product_block_offset+product_block_height-window_height)<($(this).scrollTop())){
						gettNextProductPage(pages, pages_count);
						pages_count++;
						if (pages_count > 0) {
							$('.pagination').parent().parent().find('.col-sm-6.text-right').remove();
						}
					}
				}
			});
		}
	}
});
//--></script><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-84419012-2', 'auto');
ga('send', 'pageview');
</script><div id="load_more" style="display:none;"><div class="col-sm-12 text-center"><a href="#" class="load_more btn btn-primary" rel="nofollow"><i class="fa fa-refresh"></i>Показать еще</a></div></div><!-- ModalWindow --><div id="mwHook"></div><script type="text/javascript"><!--
$(document).ready(function() {
	$.ajax({
		url : "index.php?route=module/modalwindow/modal",
		dataType: "text",
		success : function (data) {
			$("#mwHook").html(data);
			$('#').modal({
				keyboard: true,
				backdrop: true
			});
			$("#").on('hidden.bs.modal', function(){
				$.ajax({
					url : "index.php?route=module/modalwindow/mwcookie",
					dataType: "text"
				});
			});
			$(".mwaclick").on('click', function(event) {
				if (event.target.nodeName != 'A') return;
				var href = event.target.getAttribute('href');
				var date = new Date(new Date().getTime() + 3600 * 24 * 1000 * );
				var date = new Date(0);
				document.cookie = "mwcookie=mwz; expires=" + date.toUTCString();
				$("#").modal('hide');
			});
		}
	});
});
function closemw() {
	$.ajax({
		url : "index.php?route=module/modalwindow/mwcookie",
		dataType: "text"
	});
};
//--></script><!-- ModalWindow end -->
